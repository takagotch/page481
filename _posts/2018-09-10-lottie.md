---
layout: post
title:  "æœ€å¼·ã®é¢¨ä¿—æ¡ˆå†…æ‰€2ğŸ’"
categories: JavaScript
tags: åŠ¨ç”» CSS airbnb lottie JavaScript
author: HyG
---

* content
{:toc}

![](https://gw.alicdn.com/tfs/TB1yLBduDqWBKNjSZFAXXanSpXa-800-600.gif)

## ç®€ä»‹

[tkvtv](https://airbnb.design/takagotch/) æœ€å¼·ã®é¢¨ä¿—æ¡ˆå†…æ‰€ğŸ’ã€‚

ç®€å•çš„è¯´ï¼Œlottie åŠ¨ç”»åˆ¶ä½œçš„æµç¨‹æ˜¯ï¼Œé€šè¿‡ Bodymovin æ‰©å±•å°† AE åŠ¨ç”»å¯¼å‡ºä¸º json æ•°æ®ï¼Œç„¶åå†å°†è¿™ä¸ª json æ¸²æŸ“åœ¨å®¢æˆ·ç«¯æˆ–è€… web ç«¯ã€‚å¦‚ä¸‹å›¾ï¼š





![](https://gw.alicdn.com/tfs/TB1G3F7u67nBKNjSZLeXXbxCFXa-617-255.png)

å®˜ç½‘å®£ä¼ äº†3ä¸ªç‰¹æ€§ï¼š
- çµæ´»ä½¿ç”¨AEçš„ç‰¹æ€§
- éšå¿ƒæ‰€æ¬²æ§åˆ¶ä½ çš„åŠ¨ç”»
- å¾ˆå°çš„æ–‡ä»¶ä½“ç§¯

ä¸ªäººè®¤ä¸º lottie æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥å°†è®¾è®¡å¸ˆè®¾è®¡çš„åŠ¨å›¾åŸåŸæœ¬æœ¬çš„åœ¨é¡µé¢ä¸Šå±•ç°å‡ºæ¥ï¼Œå®Œç¾è¿˜åŸäº†åŠ¨ç”»çš„ç²¾ç»†åº¦ï¼Œå¹¶ä¸”å¯¹åŠ¨ç”»æ‹¥æœ‰è¶³å¤Ÿçš„æ§åˆ¶èƒ½åŠ›ã€‚ç›®å‰æ‰€æœ‰ä½¿ç”¨ gif æˆ– apng çš„åœºæ™¯åº”è¯¥éƒ½å¯ä»¥ä½¿ç”¨ lottieï¼Œå½“ç„¶ lottie ä¸å±€é™ä¸æ­¤åœºæ™¯ã€‚

æœ¬æ–‡ä¸»è¦ä»è®¾è®¡å¸ˆè§†è§’å’Œå¼€å‘è€…è§†è§’è®²è¿° lottie-web çš„åŸç†å’Œä½¿ç”¨ä»¥åŠ lottie åœ¨ weex/rax ä¸­çš„ä½¿ç”¨ã€‚

[Demo](https://gaohaoyang.github.io/lottie-test/)

<video src="http://cloud.video.taobao.com//play/u/4121310810/p/1/e/6/t/1/50255502072.mp4" autoplay controls preload loop muted width="300px"></video>

![](https://gw.alicdn.com/tfs/TB1xhmyutcnBKNjSZR0XXcFqFXa-300-300.png)

<iframe width="375px" height="500px" src="https://gaohaoyang.github.io/lottie-test/" frameborder="0"></iframe>

## è®¾è®¡å¸ˆè§†è§’

### å‡†å¤‡

åœ¨ AE ä¸­ä¸º lottie åˆ›ä½œåŠ¨ç”»ï¼Œä½ éœ€è¦ä»¥ä¸‹å‡†å¤‡
- [Adobe After Effects](https://www.adobe.com/products/aftereffects.html)
- [Bodymovin AE æ’ä»¶](http://airbnb.io/lottie/after-effects/bodymovin-installation.html)
- Lottiefiles preview app (é›†æˆäº† lottie sdk çš„ app)

å®‰è£… Bodymovin æ’ä»¶çš„æµç¨‹å¦‚ä¸‹ï¼š
1. å…³é—­ AE
2. å®‰è£… ZXP installerã€‚ ZXP Installer å°±æ˜¯ä¸“é—¨ç”¨æ¥å®‰è£… Adobe å…¬å¸çš„è½¯ä»¶äº§å“çš„æ’ä»¶çš„å·¥å…·ã€‚
3. ä¸‹è½½æœ€æ–°çš„ bodymovin æ‰©å±•ã€‚
  https://github.com/airbnb/lottie-web/blob/master/build/extension/bodymovin.zxp
  ![](https://gw.alicdn.com/tfs/TB1Q6dipMZC2uNjSZFnXXaxZpXa-2012-620.png)
4. æ‰“å¼€ ZXP installer å¹¶æŠŠ bodymovin æ‰©å±•æ‹–æ‹½è¿›æ¥
5. æ‰“å¼€ AEï¼Œåœ¨èœå• `Window > Extensions` ä¸­ï¼Œä½ ä¼šçœ‹åˆ°å®‰è£…å¥½çš„æ‰©å±•

å®‰è£…æ’ä»¶è¯¦è§ [http://airbnb.io/lottie/after-effects/bodymovin-installation.html](http://airbnb.io/lottie/after-effects/bodymovin-installation.html)

### ä» Sketch/SVG/Illustrator åˆ° Lottie çš„å·¥ä½œæµ

ä¸‹é¢è®²è®²å¦‚ä½•ä» Sketch å¼€å§‹ï¼Œåˆ¶ä½œä¸€ä¸ª lottie åŠ¨ç”»æ–‡ä»¶ã€‚å¦‚æœä½ ä½¿ç”¨ svg å›¾ç‰‡ï¼Œè·³åˆ°æ­¥éª¤3ã€‚å¦‚æœä½ ä½¿ç”¨ AIï¼Œè·³åˆ°æ­¥éª¤4ã€‚éœ€è¦å‡†å¤‡å¥½ Sketchï¼ŒAIï¼ŒAEï¼Œå¹¶å®‰è£…å¥½ Bodymovin æ’ä»¶ã€‚ä¸‹é¢å¼€å§‹ï¼š

1. åœ¨ sketch ä¸­ç¡®ä¿è¦å¯¼å‡ºçš„å†…å®¹å·²ç»ç¾¤ç»„ä¸ºä¸€ä¸ª group
2. å°†è¿™ä¸ª group å¯¼å‡ºä¸º svg
3. åœ¨ AI ä¸­æ‰“å¼€ svgï¼Œå¹¶è½¬å­˜ä¸º `.ai` æ–‡ä»¶
4. å°† `.ai` æ–‡ä»¶å¯¼å…¥åˆ° AE ä¸­
5. åœ¨ AE ä¸­åˆ›å»ºç»„ä»¶ï¼Œè®¾ç½®åŠ¨ç”»æŒç»­æ—¶é—´å’Œå¸§ç‡
6. å°† ai æ–‡ä»¶è½¬ä¸º shape layersã€‚
   åœ¨ç»„ä»¶ä¸­é€‰ä¸­ä½ çš„å›¾å±‚ï¼Œèœå• Layer ä¸­é€‰æ‹© Create shapes from vector layer
7. **æ·»åŠ ä½ æƒ³è¦çš„ä»»ä½•åŠ¨ç”»ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯ä½ ä¸»è¦å·¥ä½œçš„æ­¥éª¤**
8. ä½¿ç”¨ Bodymovin å¯¼å‡ºä¸º json
   èœå•ä¸­é€‰æ‹© Window > Extensions > Bodymovin
9. æµ‹è¯•åŠ¨ç”»ã€‚
   ç¡®ä¿åŠ¨ç”»ä¸­æ²¡æœ‰[ä¸æ”¯æŒçš„ç‰¹æ€§](http://airbnb.io/lottie/supported-features.html)ï¼Œç„¶åå¯ä»¥æ‹–æ‹½åˆ° [lottieFiles](https://www.lottiefiles.com/) ä¸­æŸ¥çœ‹æ•ˆæœã€‚
   å½“ç„¶ä¹Ÿå¯ä»¥ä¸Šä¼ åˆ° lottieFiles é‡Œï¼Œç„¶åä½¿ç”¨ lottie preview app æ‰«ç æŸ¥çœ‹ã€‚
   è¿™æ—¶ä½ å°±å¯ä»¥å°†åŠ¨ç”»äº¤ä»˜ç»™å¼€å‘åŒå­¦å•¦ï¼

æ›´å¤šç»†èŠ‚å¯æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ [Sketch/SVG/Illustrator to Lottie workflow](http://airbnb.io/lottie/after-effects/artwork-to-lottie-walkthrough.html)

### æ³¨æ„äº‹é¡¹&ä¼˜åŒ–å»ºè®®

*AE ç‰¹æ€§å¤§éƒ¨åˆ†å·²ç»æ”¯æŒï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹ [Supported Featuresï¼ˆæ”¯æŒåˆ—è¡¨ï¼‰](http://airbnb.io/lottie/supported-features.html)ï¼Œè®¾è®¡å¸ˆåº”è¯¥é¿å…ä½¿ç”¨ä¸æ”¯æŒ AE çš„ç‰¹æ€§ã€‚

ç›®å‰å¼€çœ‹ï¼Œæ”¯æŒè¾ƒå¥½çš„å±æ€§æœ‰ï¼š
- Shapes
- Fills
- Strokes
- Transforms
- Interpolation

ä¸å®Œå…¨æ”¯æŒçš„å±æ€§åˆ†ç±»æœ‰ï¼š
- Masks
- Mattes
- Merge Paths
- Layer Effects
- Text

[![](https://gw.alicdn.com/tfs/TB1ndK3uBsmBKNjSZFFXXcT9VXa-795-535.png)](http://airbnb.io/lottie/supported-features.html)


*è®¾è®¡è¿‡ç¨‹ä¸­çš„ä¼˜åŒ–å»ºè®®å’Œæ³¨æ„äº‹é¡¹ [General tips & guidelines](http://airbnb.io/lottie/after-effects/general-tips.html)

- å°½é‡ä¿æŒç®€å•å°å·§
  åœ¨ç›¸åŒçš„å›¾å±‚ä¸Šå¤åˆ¶ç›¸åŒçš„å…³é”®å¸§ä¼šå¢åŠ é¢å¤–çš„ä»£ç ï¼Œåªæœ‰åœ¨å¿…è¦æ—¶æ‰ä½¿ç”¨è·¯å¾„å…³é”®å¸§åŠ¨ç”»ã€‚
- å¯¼å‡º 1x å›¾
- No expressions or effects
  Lottie è¿˜ä¸æ”¯æŒ expressions æˆ– effects èœå•ä¸­çš„ä»»ä½• effects
- Matte and mask å°ºå¯¸é—®é¢˜
  ä½¿ç”¨åŠé€æ˜é®ç½©ä¼šå½±å“æ€§èƒ½ã€‚å¦‚æœå¿…é¡»ä½¿ç”¨é®ç½©ï¼Œè¯·è¦†ç›–æœ€å°çš„åŒºåŸŸã€‚
- ä¸æ”¯æŒ Blending modes æˆ– Luma mattes
- ä¸æ”¯æŒå›¾å±‚æ ·å¼
  å›¾å±‚æ•ˆæœä¸æ”¯æŒdrop shadow, color overlay æˆ– stroke
- å…¨å±åŠ¨ç”»ï¼Œå¯¼å‡ºæ¯”æœ€å¤§å±å¹•å®½åº¦æ›´å®½ä¸€ç‚¹çš„å›¾åƒï¼Œåœ¨ Android å’Œ iOS ä¸Šå¯ä»¥åˆ†åˆ«è£åˆ‡
  ![](http://airbnb.io/lottie/images/LottieFullScreen.gif)

## å¼€å‘è€…è§†è§’

### ä½¿ç”¨

é¦–å…ˆå½“ç„¶æ˜¯çœ‹[å¼€å‘æ–‡æ¡£](http://airbnb.io/lottie/)ã€‚è¿™é‡Œæˆ‘ç®€å•è¯´è¯´å…¶ä¸­ lottie-web çš„ä½¿ç”¨ã€‚

å¯ä»¥é€šè¿‡ script æ ‡ç­¾

``` html
<script src="https://cdnjs.com/libraries/bodymovin" type="text/javascript"></script>
```

æˆ– npm åŒ… [lottie-web](https://www.npmjs.com/package/lottie-web) å¼•ç”¨

``` bash
npm i -S lottie-web
```

``` js
import lottie from 'lottie-web'
```

è°ƒç”¨ loadAnimation()

``` js
const myLottie = lottie.loadAnimation({
  container: document.querySelector('.img-area'),
  renderer: 'svg',
  name: 'myLottieAnim',
  loop: true,
  autoplay: true,
  path: './assets/cycle_animation.json',
})
```

### å‚æ•°/api/äº‹ä»¶

loadAnimation çš„å‚æ•°

åç§° | æè¿°
--- | ---
container | ç”¨äºæ¸²æŸ“çš„å®¹å™¨ï¼Œä¸€èˆ¬ä½¿ç”¨ä¸€ä¸ª div å³å¯
renderer | æ¸²æŸ“å™¨ï¼Œå¯ä»¥é€‰æ‹© 'svg' / 'canvas' / 'html'ï¼Œä¸ªäººæµ‹è¯•å‘ç° svg æ•ˆæœå’Œå…¼å®¹æ€§æœ€å¥½
name | åŠ¨ç”»åç§°ï¼Œç”¨äº reference
loop | å¾ªç¯
autoplay | è‡ªåŠ¨æ’­æ”¾
path | json è·¯å¾„ï¼Œé¡µé¢ä¼šé€šè¿‡ä¸€ä¸ª http è¯·æ±‚è·å– json
animationData | json åŠ¨ç”»æ•°æ®ï¼Œä¸ path äº’æ–¥ï¼Œå»ºè®®ä½¿ç”¨ pathï¼Œå› ä¸º animationData ä¼šå°†æ•°æ®æ‰“åŒ…è¿›æ¥ï¼Œä¼šä½¿å¾— js bundle è¿‡å¤§

è·å–åˆ° lottie å®ä¾‹åï¼Œå¯ä»¥è°ƒç”¨ api æ§åˆ¶åŠ¨ç”»ï¼Œä¾‹å¦‚ä¸Šè¿°ä»£ç ä¸­å¯ä»¥ä½¿ç”¨

``` js
myLottie.pause()
```

ç›¸å…³ api

åç§° | å‚æ•° | æè¿°
--- | --- | ---
stop | æ—  | åœæ­¢åŠ¨ç”»
play | æ—  | æ’­æ”¾åŠ¨ç”»
pause | æ—  | æš‚åœ
setSpeed | Number | è®¾ç½®æ’­æ”¾é€Ÿåº¦ï¼Œ1 è¡¨ç¤º1å€é€Ÿåº¦ï¼Œ0.5 è¡¨ç¤º 0.5å€é€Ÿåº¦
setDirection | Number | æ­£åå‘æ’­æ”¾ï¼Œ1 è¡¨ç¤º æ­£å‘ï¼Œ-1 è¡¨ç¤ºåå‘
goToAndStop | Number, [Boolean] | è·³åˆ°æŸä¸€å¸§æˆ–æŸä¸€ç§’åœæ­¢ï¼Œç¬¬äºŒä¸ªå‚æ•° iFrame ä¸ºæ˜¯å¦åŸºäºå¸§æ¨¡å¼è¿˜æ˜¯æ—¶é—´ï¼Œé»˜è®¤ä¸º false
goToAndPlay | Number, [Boolean] | è·³åˆ°æŸä¸€å¸§æˆ–æŸä¸€ç§’å¼€å§‹ï¼Œç¬¬äºŒä¸ªå‚æ•° iFrame ä¸ºæ˜¯å¦åŸºäºå¸§æ¨¡å¼è¿˜æ˜¯æ—¶é—´ï¼Œé»˜è®¤ä¸º false
playSegments | Array, [Boolean] | æ’­æ”¾ç‰‡æ®µï¼Œå‚æ•°1ä¸ºæ•°ç»„ï¼Œä¸¤ä¸ªå…ƒç´ ä¸ºå¼€å§‹å¸§å’Œç»“æŸå¸§ï¼›å‚æ•°2ä¸ºï¼Œæ˜¯å¦ç«‹å³æ’­æ”¾ç‰‡æ®µï¼Œè¿˜æ˜¯ç­‰ä¹‹å‰çš„åŠ¨ç”»æ’­æ”¾å®Œæˆ
destroy | æ—  | é”€æ¯

äº‹ä»¶

- onComplete
- onLoopComplete
- onEnterFrame
- onSegmentStart

ä¹Ÿå¯ä»¥ä½¿ç”¨ addEventListener ç›‘å¬ä»¥ä¸‹äº‹ä»¶

- complete
- loopComplete
- enterFrame
- segmentStart
- config_ready (when initial config is done)
- data_ready (when all parts of the animation have been loaded)
- data_failed (when part of the animation can not be loaded)
- loaded_images (when all image loads have either succeeded or errored)
- DOMLoaded (when elements have been added to the DOM)
- destroy

å…·ä½“ä¹Ÿå¯ä»¥æŸ¥çœ‹[ç»„ä»¶æ–‡æ¡£](https://github.com/airbnb/lottie-web/)

### ä¼˜åŒ–å»ºè®®

- ä½¿ç”¨å‹ç¼©æ··æ·†è¿‡çš„ jsï¼Œæ¯•ç«Ÿç›®å‰ lottie-web è¿˜æ˜¯æœ‰ç‚¹å¤§ï¼Œgzip åå¤§æ¦‚ 57k
- å°½é‡ä½¿ç”¨ç®€å•å°å·§çš„ jsonï¼Œå…¶å®ä¹Ÿæ˜¯éœ€è¦åœ¨ AE ä¸­åšä¸€äº›ä¼˜åŒ–ï¼Œè¿™éœ€è¦å‰ç«¯å’Œè®¾è®¡ä¸€èµ·é…åˆå®Œæˆï¼Œä¾‹å¦‚
  - é¿å…ä½¿ç”¨å¾ˆå¤§çš„å½¢çŠ¶ï¼Œä½†æ˜¯ç”¨å¾ˆå°çš„ mask åˆ‡å‡ºæ¥
  - å¤ªå¤šçš„èŠ‚ç‚¹ä¹Ÿä¼šå½±å“æ€§èƒ½

## weex/rax ä¸­ä½¿ç”¨ lottie

weex/rax å·²ç»æä¾›äº† lottie ç»„ä»¶ï¼Œç”±äºæ˜¯å†…éƒ¨æ–‡æ¡£ï¼Œæš‚ä¸æ”¾é“¾æ¥ã€‚

api æ”¯æŒæ²¡æœ‰ airbnb å®˜æ–¹å®Œæ•´ï¼ŒæŠ•å…¥ç”Ÿäº§ç¯å¢ƒæ—¶è¿˜éœ€è¦ä¸¥æ ¼æµ‹è¯•ä¸€ä¸‹

[vue-weex demo](http://dotwe.org/vue/946e8283f5cf31cfab2f923ec8cea07c)

![](https://gw.alicdn.com/tfs/TB1h65XuCMmBKNjSZTEXXasKpXa-256-256.png)


ä½¿ç”¨[@ali/rax-lottie](http://web.npm.alibaba-inc.com/package/@ali/rax-lottie) çš„ [rax demo](https://market.m.taobao.com/app/tmall-wireless/rax-life-progress/pages/my-lottie?wh_weex=true) å¦‚ä¸‹

[![](https://gw.alicdn.com/tfs/TB16qbPuBjTBKNjSZFwXXcG4XXa-200-200.png)](https://market.m.taobao.com/app/tmall-wireless/rax-life-progress/pages/my-lottie?wh_weex=true)

<video src="http://cloud.video.taobao.com//play/u/4121310810/p/1/e/6/t/1/50255438306.mp4" autoplay controls preload loop muted width="300px"></video>

<iframe width="375px" height="200px" src="https://market.m.taobao.com/app/tmall-wireless/rax-life-progress/pages/my-lottie?wh_weex=true" frameborder="0"></iframe>

## å°ç»“

åœ¨æˆ‘çœ‹æ¥ï¼Œè¿½æ±‚æ›´ç²¾ç»†å®Œç¾çš„åŠ¨ç”»ä½“éªŒä¸€ç›´æ˜¯è®¾è®¡å¸ˆå’Œå‰ç«¯å¼€å‘çš„ä½¿å‘½ã€‚lottie çš„å‡ºç°å¯ä»¥æ›¿ä»£ä¼ ç»Ÿçš„ gifï¼Œå¹¶ä¸”æä¾›çš„ api å¯ä»¥æ›´å¥½çš„æ§åˆ¶åŠ¨ç”»ã€‚lottie å¯èƒ½ä¸é€‚åˆç”¨äºè¿‡äºå¤æ‚çš„å¤§åœºæ™¯åŠ¨ç”»ï¼Œä½†æ˜¯å±€éƒ¨çš„å°åŠ¨ç”»ï¼Œå†é€‚åˆä¸è¿‡äº†ã€‚

lottie åº”è¯¥æ˜¯ä¸€ä¸ªå‘å±•è¶‹åŠ¿ï¼Œç”šè‡³æœªæ¥æµè§ˆå™¨è¯´ä¸å®šå°±åŸç”Ÿç›´æ¥æ”¯æŒäº†è¿™ç§ json åŠ¨ç”»ï¼Œè®¾è®¡å’Œå¼€å‘ä¹‹é—´çš„å£å’ä¹Ÿä¼šè¶Šæ¥è¶Šå°ã€‚
